#:import ChatBubble View.libs.uix.baseclass.chat_bubble
#:import UserListItem View.libs.uix.baseclass.listitem
#:import UserListItem View.libs.uix.baseclass.clickabletextfield

<ChatScreen>
    name: "chat"
    GridLayout:
        cols: 2
        rows: 2

        BoxLayout:
            size_hint: .7, .9
            canvas.before:
                Color:
                    rgba: (33/255, 150/255, 243/255, .2)
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
            RecycleView:
                id: chat_rv
                data: root.chat_logs
                viewclass: "ChatBubble"
                size_hint: .5, .989

                RecycleBoxLayout:
                    id: box
                    padding: dp(10)
                    spacing: dp(15)
                    orientation: "vertical"
                    size_hint_y: None
                    height: self.minimum_size[1]
                    default_size_hint: .7, None
                    default_size: None, None

        BoxLayout:
            orientation: 'vertical'
            size_hint: .3, .9
            MDIconButton:
                icon: "logout"
                pos_hint: {"center_x": .9, "center_y": .8}
                disabled: self.parent.disabled
                opacity: self.parent.opacity
                on_release: app.root.log_out()

            MDBoxLayout:
                orientation: 'vertical'
                MDLabel:
                    id: header_text
                    text: "USERS"
                    halign: "center"
                    font_style: "H6"
                    size_hint: .9, .1
                    pos_hint: {"center_x": .5}
                RecycleView:
                    id: users_rv
                    data: root.users
                    viewclass: 'UserListItem'
                    canvas.before:
                        Color:
                            rgba: (255/255, 193/255, 7/255, 1)
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [15]
                        Color:
                            rgba: (1,1,1, 1)
                        RoundedRectangle:
                            size: self.width-8, self.height-8
                            pos: self.x+4, self.y+4
                        Color:
                            rgba: (33/255, 150/255, 243/255, .2)
                        RoundedRectangle:
                            size: self.width-8, self.height-8
                            pos: self.x+4, self.y+4

                    RecycleBoxLayout:
                        padding: dp(10)
                        spacing: dp(10)
                        orientation: "vertical"
                        size_hint_y: None
                        height: self.minimum_size[1]
                        default_size_hint: 1, None
                        default_size: None, None

                MDIconButton:
                    icon: "refresh"
                    pos_hint: {"center_x": .9, "center_y": .1}
                    disabled: self.parent.disabled
                    opacity: self.parent.opacity
                    on_release: app.root.update_users()

        AnchorLayout:
            size_hint: .5, .1
            ClickableTextFieldRound:
                id: field
                anchor_x: "center"
                anchor_y: "center"
                size_hint_max_x: 450



<BackgroundColor@Widget>
    background_color: 1, .3, .5, 1
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos

